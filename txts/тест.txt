- всегда есть канал в списке каналов дефолтный который добавляется при создании и который нельзя удал ить
-------------------------------------------------------------------------------------------------------------------


канал GENERAL
1. при создании создаётся канал general который помечается 
2. в настройках у этого канада нет кнопки удалить
3. при удалении любого канала прыгает на general
4. в рест апи удаления канала идёт проверка на флаг general

варианты реакции на удаление
1. помечать канал как удаленный, и то затемнять его ( на стороне удаляющего можно сделать переход на general)
2. 


-------------------------------------------------------------------------------------------------------------------
Юзеры онлайн

сейчас хронятся в переменной

вопросы:
0. пересекается ли статус онлайн с остальными ?? 
0.0.1 как вобще хранить статусы 
в базе?
в дискорде в сеттингах хронят , тоесть я так поимаю в базе ( пробежала мыстль что может както с сессией связано)

в сокете?


0.1.  

1. нужно ли разделять юзеров онлайн по серверам?

тоесть 2 сутации: - 1.  неразделяем 
	  	  - 2.

вариант 
отправляем айдишник юзера при конекте и дисконекте
при этом берем начальную точку из общего списка.
должна ли начальная точка принадлежать серверу - 
выходит что да потомучто иначе будут отосланы все юзеры онлайн всего сервиса


ну норм 


странный вариант
при конекте юзера отправлять ему от юзеров онлайн что они онлайн


в редуксе хранить отдельным списком или в юзара записывать что он онлайн

2. где хранить юзеров онлайн. 



ответы:
- хроним только айдишники
- в идеале отпралять по одному айдишнику при конекте и дисконекте

- мы выяснили что переодически происходит дисконект и коннект, и именно в паре.
  это позволит сохранять актуальность юзеров онлайн


-------------------------------------------------------------------------------------------------------------------


в предыдущей схеме есть дублирование ролей? - ответ НЕТУ!



юзер может иметь больше одной роли или нет.
как реализовать сервер оунера в контексте RBAC?
имеется ввиду: как дать все права оунеру при создании сервера
Варианты 
1. при создании сервера, юзеру отадаёся роль админа (в контексте этого сервера), который может всё 

еще нужна роль для пользователей по умолчанию, тоесть когда я становлюсь мембером сервера
мне передаётся роль в контексте сервера- это значит что у юзера НЕ может НЕ быть роли на сервере.
при создании сервера придётся создовать свою "начальную роль" иначе её нельзя будет редактировать 

как решить вопрос атрибута: было круто писать функцию в проперти потомучто она тогда всегда есть у роли,
иначе придётся дописывать предикат прямо рядом *can* функцией.
есть варианты? 
ну первый : всё таки писать предикат рядом с функцией;
второй:
как мы выяснили функию хранить в базе мы не можем,
надо либо подсовывать както функцию,
либо както её формировать на основе данных в базе.
если бы просто наличие атрибута надо ,было бы проще,
но ведь может быть и проверка на равенство или типа того,
тоесть сравнение уже двух атрибутов

что нужно для функции чтобы её можно было построить на атрибутах.







Возможности ACL
1. добавление новой роли / удаление роли
2. редактирование роли

3. добавление роли к юзеру
4. чтение ролей юзера
5. чтение пермишинов

6. можно получить юзеров по ролям .. roleUsers( rolename, function(err, users) )
7. можно проверить имеет ли юзер роль .. 
8. можно даследоваться от ролей ( может это использовать для серверов? хотя сервер это ресурс ) 

9. можно удалять ресурс.. как это использовать?
10. удаление пермишинов из роли
11. можно получить ресурсы из роли ( можно указвать пермишин)
Как разделять роли по серверам?
добавление ролей чисто под сервер? .. hasRole( userId, rolename, function(err, hasRole) )



ре


Список мемберов сервера------------------------------------------------

Когда юзер становится мембером сервера:
1. При создании своего сервера , юзер автоматом становится мембером этого сервера; УЖЕ СДЕЛАНО
2. Когда юзер заходит первый раз на этот сервер (тоесть добавляет его в свой список серверов);
	Как добавить в список: чз инвайт -> ссылка по которой происходит добавление в список серверов текущего юзера в токене.

Когда юзер перестаёт быть мембером сервера:
1. когда юзер нажимает покинуть сервер ( когда удаляет сервер из своего списка серверов)
2. когда админ выгоняет 

Отображение списка юзера:

Полностью грузить весь список возможно не вариант.
вариант 1:  Грузим первую часть, Делаем кнопку подгрузить остальные

в slack отображаются все - возможно они грузятся во время начальной полной загрузки, которая есть и в slack и в discordapp

а в discordapp отображаются только пользователи в сети. что впринцепе норм 

в данный момент уже отображается пользователи онлайн, но без разбивки по ролям...
правда они отображаются без привязки к серверу.
если сервер будет комнатой то можно врнципе получить список сокетов комнаты


опять же вопрос сыпятся ли сообщения от всех серверов?
В discordapp  сыпятся
в Слаке походу нет  



для списка в любом случае нужна привязка к серверу


Список серверов юзера-----------------------------------------------------------------------------------------------

нужен список серверов юзера:
можно вытянуть из юзера поидее











----------------------------------OLD------------------------------------------------------------



отправка сообещния.





2 варианта 

1. как сейчас чз сокет 

2. чз XHR

	тогда придётся оповещать сокеты внури обрабочитка роута.

вроде в этом ничего плохого нет а иначе как еще.


1. получить данные юзера ( как минимум нужен ид для оптравки сообщения)

____________________________
пользователь можно создавать сообщения только от себя
на сервере нужно проверять может ли 
как реализовать ?? 

варианты:
1. можно/нужно распарсить токен и взять оттуда id, это даёт:
   a) соощение можно создать только на основании токена ( как в прочем и всё другое, но тут просто еще нужно ид достать из токена
	где мы еще можем взять его : только из сессия которую как бы и заменяет токен. Больше неоткуда)
	)
   b) если послать сообщение с ид юзера , и оно не совпадет с токеном то блочим. 
	( чем отличается от обычной блокировки: тем что в общей какбы ненужно соотвествие данных и стокеном, нужен просто валидный токен)
         таким образом нужно сделать както допроверку на соответстивие. потомучто тут идет речь не только о создании сообщения но и об 
	остальных вещах :  к примеру доступ к профилю другого юзера.
	... смотрим реализацию jwт стратегии





исходные данные:
есть токен на клиент, надо его просто проверить, 

может ли функция проверки передать самого юзера чтобы его второй раз не искать